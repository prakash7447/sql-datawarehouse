select * ,
case when cid like 'NAS%' then SUBSTRING(cid,4,len(cid))
else cid 
end as cid_,
case 
when bdate>getdate() then null
else bdate
end as bdate,
case
when upper(trim(gen)) in ('M','MALE') Then 'Male'
when upper(trim(gen)) in ('F','FEMALE') Then 'Female'
else 'n/a'
end as gen
from bronze.erp_cust_az12

--looking into all the gender types

select distinct
gen from bronze.erp_cust_az12

--checking if anyone bdate is greater than today

select distinct
bdate from
bronze.erp_cust_az12
where bdate>getdate() or bdate <='1926-02-06'
